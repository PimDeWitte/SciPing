//
//  RTD2 - Twitter bot that tweets about the most popular github.com news
//  Also makes new friends and prunes its followings.
//

var INTERVAL = 60000;

var config = {
    "consumer_key": 'fW09KUsqOHzVoTUPdruc5bgoo'
    , "consumer_secret": 'YiLik1YNOMxXrUgveiq8YHisSbfmWuz5Bor6Ek3RClM0XdSzI3'
    , "access_token": '2808125833-41UZURECzuW5j18htCxrev93Ql6ykK6tH1KGRsU'
    , "access_token_secret": 'ELEXYBVaQ2gDavSfCFpHAvLukxgZsHIjvKIfTiGVYRuRM'
};

var Bot = require('./bot');

var bot = new Bot(config);

var followers = [];
var isFillingList = false;

console.log('RTD2: Running.');

//get date string for today's date (e.g. '2011-01-01')
function datestring () {
  var d = new Date(Date.now() - 5*60*60*1000);  //est timezone
  return d.getUTCFullYear()   + '-'
     +  (d.getUTCMonth() + 1) + '-'
     +   d.getDate();
};
var processingFunction = function() {
    bot.twit.get('followers/ids', function(err, reply) {
        if(err) return handleError(err)
        isFillingList = true;
        followers = [];
        for(var i = 0; i < reply.ids.length; i++) {
           followers.push(reply.ids[i]);
        }
        isFillingList = false;
        console.log('\n# followers:' + reply.ids.length.toString());

        console.log("fol len:"+followers.length);
        for(var i = 0; i < followers.length; i++) {
            console.log(followers[i]);
        }
    });



};


processingFunction();
setInterval(processingFunction, INTERVAL);

function handleError(err) {
  console.error('response status:', err.statusCode);
  console.error('data:', err.data);
}
